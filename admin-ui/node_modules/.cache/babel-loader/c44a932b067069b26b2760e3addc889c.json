{"remainingRequest":"D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\src\\store\\modules\\permission.js","mtime":1741918744869},{"path":"D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\babel.config.js","mtime":1741918744622},{"path":"D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741918921836},{"path":"D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1741918936941},{"path":"D:\\codeidea\\bishe4\\dts-shop\\admin-ui\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1741918926320}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi9jb2RlaWRlYS9iaXNoZTQvZHRzLXNob3AvYWRtaW4tdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnZhciBfb2JqZWN0U3ByZWFkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiRDovY29kZWlkZWEvYmlzaGU0L2R0cy1zaG9wL2FkbWluLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL29iamVjdFNwcmVhZDIuanMiKSk7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5jb25zdHJ1Y3Rvci5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZm9yLWVhY2guanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLnNvbWUuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyIpOwp2YXIgX3JvdXRlciA9IHJlcXVpcmUoIkAvcm91dGVyIik7Ci8qKg0KICog6YCa6L+HbWV0YS5wZXJtc+WIpOaWreaYr+WQpuS4juW9k+WJjeeUqOaIt+adg+mZkOWMuemFjQ0KICogQHBhcmFtIHBlcm1zDQogKiBAcGFyYW0gcm91dGUNCiAqLwpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHBlcm1zLCByb3V0ZSkgewogIGlmIChyb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEucGVybXMpIHsKICAgIHJldHVybiBwZXJtcy5zb21lKGZ1bmN0aW9uIChwZXJtKSB7CiAgICAgIHJldHVybiByb3V0ZS5tZXRhLnBlcm1zLmluY2x1ZGVzKHBlcm0pOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqDQogKiDpgJLlvZLov4fmu6TlvILmraXot6/nlLHooajvvIzov5Tlm57nrKblkIjnlKjmiLfop5LoibLmnYPpmZDnmoTot6/nlLHooagNCiAqIEBwYXJhbSByb3V0ZXMgYXN5bmNSb3V0ZXJNYXANCiAqIEBwYXJhbSBwZXJtcw0KICovCmZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVyKHJvdXRlcywgcGVybXMpIHsKICB2YXIgcmVzID0gW107CiAgcm91dGVzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlKSB7CiAgICB2YXIgdG1wID0gKDAsIF9vYmplY3RTcHJlYWQyLmRlZmF1bHQpKHt9LCByb3V0ZSk7CiAgICBpZiAodG1wLmNoaWxkcmVuKSB7CiAgICAgIHRtcC5jaGlsZHJlbiA9IGZpbHRlckFzeW5jUm91dGVyKHRtcC5jaGlsZHJlbiwgcGVybXMpOwogICAgICBpZiAodG1wLmNoaWxkcmVuICYmIHRtcC5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgcmVzLnB1c2godG1wKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGhhc1Blcm1pc3Npb24ocGVybXMsIHRtcCkpIHsKICAgICAgICByZXMucHVzaCh0bXApOwogICAgICB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlczsKfQp2YXIgcGVybWlzc2lvbiA9IHsKICBzdGF0ZTogewogICAgcm91dGVyczogX3JvdXRlci5jb25zdGFudFJvdXRlck1hcCwKICAgIGFkZFJvdXRlcnM6IFtdCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIFNFVF9ST1VURVJTOiBmdW5jdGlvbiBTRVRfUk9VVEVSUyhzdGF0ZSwgcm91dGVycykgewogICAgICBzdGF0ZS5hZGRSb3V0ZXJzID0gcm91dGVyczsKICAgICAgc3RhdGUucm91dGVycyA9IF9yb3V0ZXIuY29uc3RhbnRSb3V0ZXJNYXAuY29uY2F0KHJvdXRlcnMpOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgR2VuZXJhdGVSb3V0ZXM6IGZ1bmN0aW9uIEdlbmVyYXRlUm91dGVzKF9yZWYsIGRhdGEpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICB2YXIgcGVybXMgPSBkYXRhLnBlcm1zOwogICAgICAgIHZhciBhY2Nlc3NlZFJvdXRlcnM7CiAgICAgICAgaWYgKHBlcm1zLmluY2x1ZGVzKCcqJykpIHsKICAgICAgICAgIGFjY2Vzc2VkUm91dGVycyA9IF9yb3V0ZXIuYXN5bmNSb3V0ZXJNYXA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFjY2Vzc2VkUm91dGVycyA9IGZpbHRlckFzeW5jUm91dGVyKF9yb3V0ZXIuYXN5bmNSb3V0ZXJNYXAsIHBlcm1zKTsKICAgICAgICB9CiAgICAgICAgY29tbWl0KCdTRVRfUk9VVEVSUycsIGFjY2Vzc2VkUm91dGVycyk7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KTsKICAgIH0KICB9Cn07CnZhciBfZGVmYXVsdCA9IGV4cG9ydHMuZGVmYXVsdCA9IHBlcm1pc3Npb247"},{"version":3,"names":["_router","require","hasPermission","perms","route","meta","some","perm","includes","filterAsyncRouter","routes","res","forEach","tmp","_objectSpread2","default","children","length","push","permission","state","routers","constantRouterMap","addRouters","mutations","SET_ROUTERS","concat","actions","GenerateRoutes","_ref","data","commit","Promise","resolve","accessedRouters","asyncRouterMap","_default","exports"],"sources":["D:/codeidea/bishe4/dts-shop/admin-ui/src/store/modules/permission.js"],"sourcesContent":["import { asyncRouterMap, constantRouterMap } from '@/router'\r\n\r\n/**\r\n * 通过meta.perms判断是否与当前用户权限匹配\r\n * @param perms\r\n * @param route\r\n */\r\nfunction hasPermission(perms, route) {\r\n  if (route.meta && route.meta.perms) {\r\n    return perms.some(perm => route.meta.perms.includes(perm))\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n/**\r\n * 递归过滤异步路由表，返回符合用户角色权限的路由表\r\n * @param routes asyncRouterMap\r\n * @param perms\r\n */\r\nfunction filterAsyncRouter(routes, perms) {\r\n  const res = []\r\n\r\n  routes.forEach(route => {\r\n    const tmp = { ...route }\r\n    if (tmp.children) {\r\n      tmp.children = filterAsyncRouter(tmp.children, perms)\r\n      if (tmp.children && tmp.children.length > 0) {\r\n        res.push(tmp)\r\n      }\r\n    } else {\r\n      if (hasPermission(perms, tmp)) {\r\n        res.push(tmp)\r\n      }\r\n    }\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nconst permission = {\r\n  state: {\r\n    routers: constantRouterMap,\r\n    addRouters: []\r\n  },\r\n  mutations: {\r\n    SET_ROUTERS: (state, routers) => {\r\n      state.addRouters = routers\r\n      state.routers = constantRouterMap.concat(routers)\r\n    }\r\n  },\r\n  actions: {\r\n    GenerateRoutes({ commit }, data) {\r\n      return new Promise(resolve => {\r\n        const { perms } = data\r\n        let accessedRouters\r\n        if (perms.includes('*')) {\r\n          accessedRouters = asyncRouterMap\r\n        } else {\r\n          accessedRouters = filterAsyncRouter(asyncRouterMap, perms)\r\n        }\r\n        commit('SET_ROUTERS', accessedRouters)\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default permission\r\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AAEA;AACA;AACA;AACA;AACA;AACA,SAASC,aAAaA,CAACC,KAAK,EAAEC,KAAK,EAAE;EACnC,IAAIA,KAAK,CAACC,IAAI,IAAID,KAAK,CAACC,IAAI,CAACF,KAAK,EAAE;IAClC,OAAOA,KAAK,CAACG,IAAI,CAAC,UAAAC,IAAI;MAAA,OAAIH,KAAK,CAACC,IAAI,CAACF,KAAK,CAACK,QAAQ,CAACD,IAAI,CAAC;IAAA,EAAC;EAC5D,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASE,iBAAiBA,CAACC,MAAM,EAAEP,KAAK,EAAE;EACxC,IAAMQ,GAAG,GAAG,EAAE;EAEdD,MAAM,CAACE,OAAO,CAAC,UAAAR,KAAK,EAAI;IACtB,IAAMS,GAAG,OAAAC,cAAA,CAAAC,OAAA,MAAQX,KAAK,CAAE;IACxB,IAAIS,GAAG,CAACG,QAAQ,EAAE;MAChBH,GAAG,CAACG,QAAQ,GAAGP,iBAAiB,CAACI,GAAG,CAACG,QAAQ,EAAEb,KAAK,CAAC;MACrD,IAAIU,GAAG,CAACG,QAAQ,IAAIH,GAAG,CAACG,QAAQ,CAACC,MAAM,GAAG,CAAC,EAAE;QAC3CN,GAAG,CAACO,IAAI,CAACL,GAAG,CAAC;MACf;IACF,CAAC,MAAM;MACL,IAAIX,aAAa,CAACC,KAAK,EAAEU,GAAG,CAAC,EAAE;QAC7BF,GAAG,CAACO,IAAI,CAACL,GAAG,CAAC;MACf;IACF;EACF,CAAC,CAAC;EAEF,OAAOF,GAAG;AACZ;AAEA,IAAMQ,UAAU,GAAG;EACjBC,KAAK,EAAE;IACLC,OAAO,EAAEC,yBAAiB;IAC1BC,UAAU,EAAE;EACd,CAAC;EACDC,SAAS,EAAE;IACTC,WAAW,EAAE,SAAbA,WAAWA,CAAGL,KAAK,EAAEC,OAAO,EAAK;MAC/BD,KAAK,CAACG,UAAU,GAAGF,OAAO;MAC1BD,KAAK,CAACC,OAAO,GAAGC,yBAAiB,CAACI,MAAM,CAACL,OAAO,CAAC;IACnD;EACF,CAAC;EACDM,OAAO,EAAE;IACPC,cAAc,WAAdA,cAAcA,CAAAC,IAAA,EAAaC,IAAI,EAAE;MAAA,IAAhBC,MAAM,GAAAF,IAAA,CAANE,MAAM;MACrB,OAAO,IAAIC,OAAO,CAAC,UAAAC,OAAO,EAAI;QAC5B,IAAQ9B,KAAK,GAAK2B,IAAI,CAAd3B,KAAK;QACb,IAAI+B,eAAe;QACnB,IAAI/B,KAAK,CAACK,QAAQ,CAAC,GAAG,CAAC,EAAE;UACvB0B,eAAe,GAAGC,sBAAc;QAClC,CAAC,MAAM;UACLD,eAAe,GAAGzB,iBAAiB,CAAC0B,sBAAc,EAAEhC,KAAK,CAAC;QAC5D;QACA4B,MAAM,CAAC,aAAa,EAAEG,eAAe,CAAC;QACtCD,OAAO,CAAC,CAAC;MACX,CAAC,CAAC;IACJ;EACF;AACF,CAAC;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAtB,OAAA,GAEcI,UAAU","ignoreList":[]}]}